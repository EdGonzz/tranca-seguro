---
import Copy from "@/assets/svg/copy.svg";
import Eye from "@/assets/svg/eye.svg";
import EyeOff from "@/assets/svg/eye-off.svg";
---

<label for="generated-password" class="text-sm"
  >Tu contraseña segura</label
>
<div class="relative">
  <input
    class="w-full pr-12 pl-4 py-3 bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-md text-sm text-slate-700 dark:text-slate-300 font-mono tracking-wider"
    id="generated-password"
    placeholder="Su contraseña segura aparecerá aquí"
    readonly=""
    type="password"
  />
  <button
    id="show-password"
    aria-label="Copiar contraseña"
    class="absolute inset-y-0 right-13 flex items-center text-gray-400 hover:text-primary transition-all"
    type="button"
  >
    <EyeOff id="eye-off" />
    <Eye id="eye" class="hidden" />
  </button>
  <button
    id="copy-password"
    aria-label="Copiar contraseña"
    class="absolute inset-y-0 right-4 flex items-center text-gray-400 hover:text-primary transition-all"
    type="button"
  >
    <Copy />
  </button>
</div>

<script>
  import { toast } from "@/tools/toast";
  const $generatedPassword = document.getElementById(
    "generated-password"
  ) as HTMLInputElement;
  const $showPassword = document.getElementById(
    "show-password"
  ) as HTMLButtonElement;
  const $copyPassword = document.getElementById(
    "copy-password"
  ) as HTMLButtonElement;
  const $textCopied = document.getElementById("text-copied") as HTMLSpanElement;
  const $eyeOff = document.getElementById("eye-off") as HTMLElement;
  const $eye = document.getElementById("eye") as HTMLElement;

  $copyPassword.addEventListener("click", () => {
    if ($generatedPassword.value) {
      navigator.clipboard.writeText($generatedPassword.value);
      toast({
        message: "Contraseña copiada en el portapapeles",
        type: "info",
      });
    }
  });

  $showPassword.addEventListener("click", () => {
    if ($generatedPassword.type === "password") {
      $generatedPassword.type = "text";
      $eyeOff.classList.add("hidden");
      $eye.classList.remove("hidden");
    } else {
      $generatedPassword.type = "password";
      $eyeOff.classList.remove("hidden");
      $eye.classList.add("hidden");
    }
  });
</script>
